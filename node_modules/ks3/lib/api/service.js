var auth = require('./../auth');
var config = require('./../../config');

/**
 * 获取bucket列表
 */
function get(params, cb) {
	if(typeof params === 'function') {
		cb = params
	}
	
	var req = _getServiceRequestParams.call(this, '', 'GET', params)

	var authStr = auth.generateAuth(this.ak, this.sk, req);
	var body = null;

	this.request(req, body, authStr, cb);
}

function _getServiceRequestParams (type, method, params) {
	var date = (new Date()).toUTCString();
	var projectIds = params && (params.ProjectIds || params.projectIds)
	var resource = projectIds ? '?projectIds=' + projectIds : ''

	var uri = config.protocol + '://' + config.baseUrl + resource
	
	var req = {
		method,
		date: date,
		uri: uri,
		resource: '/'
	}
	
	if (this.timeout) req.timeout = this.timeout

	if (this.securityToken) req.headers['x-kss-security-token'] = this.securityToken

	return req
}

module.exports = {
	get: get,
	listBucket:get
}

